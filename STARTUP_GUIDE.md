# SpiderMail å¯åŠ¨æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

SpiderMail æ˜¯ä¸€ä¸ªç”µå•†æ•°æ®çˆ¬è™«é¡¹ç›®ï¼Œç”¨äºä»æ·˜å®å’Œäº¬ä¸œç­‰å¹³å°æå–äº§å“å’Œè¯„è®ºæ•°æ®ã€‚é¡¹ç›®å·²é…ç½®å¥½æ•°æ®åº“è¿æ¥å¹¶å¯æ­£å¸¸è¿è¡Œã€‚

## å®Œæˆçš„é…ç½®

### âœ… ç¯å¢ƒé…ç½®
- Python 3.12+ è™šæ‹Ÿç¯å¢ƒè®¾ç½®
- ä½¿ç”¨ uv ç®¡ç†ä¾èµ–åŒ…
- æ‰€æœ‰å¿…éœ€ä¾èµ–å·²å®‰è£…

### âœ… æ•°æ®åº“é…ç½®
- **æ•°æ®åº“ç±»å‹**: PostgreSQL 14.19
- **ä¸»æœº**: 103.36.221.226
- **ç«¯å£**: 5432
- **æ•°æ®åº“å**: spider-mall
- **ç”¨æˆ·å**: loemon
- **å¯†ç **: lemon2judy
- **çŠ¶æ€**: âœ… è¿æ¥æˆåŠŸï¼Œè¡¨å·²åˆ›å»º

### âœ… é¡¹ç›®ç»“æ„
```
spiderMail/
â”œâ”€â”€ src/spidermail/          # ä¸»è¦ä»£ç 
â”‚   â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ database/           # æ•°æ®åº“è¿æ¥å’Œæ¨¡å‹
â”‚   â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ spiders/            # çˆ¬è™«å®ç°
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ cli.py              # å‘½ä»¤è¡Œæ¥å£
â”‚   â””â”€â”€ scheduler.py        # ä»»åŠ¡è°ƒåº¦å™¨
â”œâ”€â”€ logs/                   # æ—¥å¿—ç›®å½•
â”œâ”€â”€ database/               # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ test_run.py            # ç³»ç»Ÿæµ‹è¯•è„šæœ¬
â”œâ”€â”€ start_simple.py        # ç®€åŒ–å¯åŠ¨è„šæœ¬
â””â”€â”€ STARTUP_GUIDE.md       # æœ¬æ–‡ä»¶
```

## å¦‚ä½•ä½¿ç”¨é¡¹ç›®

### 1. ç³»ç»ŸçŠ¶æ€æ£€æŸ¥

```bash
# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
uv run python start_simple.py status

# è¿è¡Œå®Œæ•´æµ‹è¯•
uv run python test_run.py
```

### 2. æµ‹è¯•çˆ¬è™«åŠŸèƒ½

```bash
# æµ‹è¯•æ·˜å®çˆ¬è™«
uv run python start_simple.py test taobao

# æµ‹è¯•äº¬ä¸œçˆ¬è™«
uv run python start_simple.py test jd
```

### 3. ä½¿ç”¨åŸå§‹CLIï¼ˆå¯èƒ½æœ‰ç¼–ç é—®é¢˜ï¼‰

åŸå§‹CLIåŒ…å«emojiå­—ç¬¦ï¼Œåœ¨æŸäº›Windowsç¯å¢ƒä¸‹å¯èƒ½æ˜¾ç¤ºå¼‚å¸¸ï¼Œä½†åŠŸèƒ½æ­£å¸¸ï¼š

```bash
# æŸ¥çœ‹é…ç½®ï¼ˆå¯èƒ½æœ‰ç¼–ç é—®é¢˜ï¼‰
uv run spidermail config

# åˆå§‹åŒ–æ•°æ®åº“
uv run spidermail init-db

# æ‰‹åŠ¨çˆ¬å–æ•°æ®
uv run spidermail crawl --platform taobao --category æ‰‹æœº --pages 3

# å¯åŠ¨è°ƒåº¦å™¨
uv run spidermail start-scheduler
```

### 4. ç¼–ç¨‹æ–¹å¼ä½¿ç”¨

```python
import sys
sys.path.insert(0, 'src')

from spidermail.spiders.taobao_spider import TaobaoSpider
from spidermail.database.connection import db_manager

# åˆ›å»ºçˆ¬è™«å®ä¾‹
spider = TaobaoSpider()

# æœç´¢äº§å“
products = spider.search_products("æ‰‹æœº", page=1)

# æ•°æ®åº“æ“ä½œ
with db_manager.get_session() as session:
    # è¿›è¡Œæ•°æ®åº“æ“ä½œ
    pass
```

## åŠŸèƒ½ç‰¹æ€§

### ğŸ•·ï¸ çˆ¬è™«åŠŸèƒ½
- **æ·˜å®çˆ¬è™«**: æœç´¢äº§å“ã€æå–è¯„è®º
- **äº¬ä¸œçˆ¬è™«**: æœç´¢äº§å“ã€æå–è¯„è®º
- **ååçˆ¬è™«**: ç”¨æˆ·ä»£ç†è½®æ¢ã€è¯·æ±‚å»¶è¿Ÿ
- **é”™è¯¯é‡è¯•**: è‡ªåŠ¨é‡è¯•æœºåˆ¶

### ğŸ’¾ æ•°æ®å­˜å‚¨
- **äº§å“ä¿¡æ¯**: æ ‡é¢˜ã€ä»·æ ¼ã€å“ç‰Œã€è§„æ ¼ç­‰
- **è¯„è®ºæ•°æ®**: è¯„åˆ†ã€å†…å®¹ã€æ—¶é—´ç­‰
- **ä»·æ ¼å†å²**: ä»·æ ¼å˜åŒ–è¿½è¸ª
- **ä»»åŠ¡è®°å½•**: çˆ¬å–ä»»åŠ¡çŠ¶æ€

### â° è°ƒåº¦åŠŸèƒ½
- **å®šæ—¶ä»»åŠ¡**: æ¯æ—¥è‡ªåŠ¨çˆ¬å–
- **æ‰‹åŠ¨è§¦å‘**: æŒ‰éœ€æ‰§è¡Œçˆ¬å–
- **å¤±è´¥é‡è¯•**: è‡ªåŠ¨é‡è¯•æœºåˆ¶

## é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½® (src/spidermail/config/settings.py)
```python
database:
  host: 103.36.221.226
  port: 5432
  database: spider-mall
  username: loemon
  password: lemon2judy
```

### çˆ¬è™«é…ç½®
```python
spider:
  request_delay: 1.0          # è¯·æ±‚å»¶è¿Ÿï¼ˆç§’ï¼‰
  max_retries: 3              # æœ€å¤§é‡è¯•æ¬¡æ•°
  timeout: 30                 # è¯·æ±‚è¶…æ—¶æ—¶é—´
  concurrent_requests: 5      # å¹¶å‘è¯·æ±‚æ•°
```

### è°ƒåº¦é…ç½®
```python
schedule:
  enabled: true               # å¯ç”¨è°ƒåº¦å™¨
  crawl_time: "02:00"        # æ¯æ—¥çˆ¬å–æ—¶é—´
  timezone: "Asia/Shanghai"   # æ—¶åŒºè®¾ç½®
```

## æ•…éšœæ’é™¤

### 1. ç¼–ç é—®é¢˜
Windowsä¸‹emojiå­—ç¬¦æ˜¾ç¤ºå¼‚å¸¸æ˜¯æ­£å¸¸çš„ï¼ŒåŠŸèƒ½ä¸å—å½±å“ã€‚ä½¿ç”¨ `start_simple.py` å¯é¿å…æ­¤é—®é¢˜ã€‚

### 2. çˆ¬è™«æ— æ•°æ®
æ·˜å®/äº¬ä¸œæœ‰åçˆ¬è™«æœºåˆ¶ï¼Œè¿”å›ç©ºæ•°æ®æ˜¯æ­£å¸¸ç°è±¡ã€‚å¯ä»¥å°è¯•ï¼š
- æ›´æ¢æœç´¢å…³é”®è¯
- è°ƒæ•´è¯·æ±‚å‚æ•°
- ä½¿ç”¨ä»£ç†

### 3. æ•°æ®åº“è¿æ¥å¤±è´¥
æ£€æŸ¥æ•°æ®åº“é…ç½®å’Œç½‘ç»œè¿æ¥ï¼Œç¡®ä¿ï¼š
- æ•°æ®åº“æœåŠ¡æ­£å¸¸è¿è¡Œ
- ç½‘ç»œè¿æ¥é€šç•…
- ç”¨æˆ·åå¯†ç æ­£ç¡®

## ä¸‹ä¸€æ­¥å¼€å‘å»ºè®®

1. **å¢å¼ºåçˆ¬è™«èƒ½åŠ›**: æ·»åŠ æ›´å¤šç”¨æˆ·ä»£ç†ã€ä»£ç†æ± 
2. **æ•°æ®æ¸…æ´—**: å®ç°æ›´å¥½çš„æ•°æ®æ¸…æ´—å’ŒéªŒè¯
3. **APIæ¥å£**: æ·»åŠ REST APIæä¾›æ•°æ®è®¿é—®
4. **æ•°æ®å¯è§†åŒ–**: æ·»åŠ æ•°æ®å±•ç¤ºå’Œåˆ†æåŠŸèƒ½
5. **åˆ†å¸ƒå¼éƒ¨ç½²**: æ”¯æŒå¤šæœºå™¨åˆ†å¸ƒå¼çˆ¬å–

## æŠ€æœ¯æ ˆ

- **Python**: 3.12+
- **Webæ¡†æ¶**: æ— ï¼ˆçˆ¬è™«é¡¹ç›®ï¼‰
- **æ•°æ®åº“**: PostgreSQL 14.19
- **ORM**: SQLAlchemy
- **çˆ¬è™«**: requests, BeautifulSoup4, selenium
- **è°ƒåº¦**: schedule, celery
- **æ—¥å¿—**: loguru
- **é…ç½®**: pydantic
- **åŒ…ç®¡ç†**: uv

---

**é¡¹ç›®çŠ¶æ€**: âœ… å·²é…ç½®å®Œæˆï¼Œå¯æ­£å¸¸è¿è¡Œ
**æœ€åæ›´æ–°**: 2025-11-25